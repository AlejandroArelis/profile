import{a as X,b as Y,c as Z,e as ee}from"./chunk-KCBB6BK3.js";import{a as te}from"./chunk-PRF5ZHG6.js";import{B as P,r as Q,s as j,t as q,u as L,w as H,x as z,y as J,z as K}from"./chunk-OMH7WZUU.js";import{a as U,j as B,m as O,r as W}from"./chunk-YR4DBCNH.js";import"./chunk-WXI33M2S.js";import{Ab as M,Bb as R,Cb as m,Db as C,Eb as A,Kb as x,Na as u,Oa as a,T as F,Z as T,a as g,aa as w,db as I,fb as V,jb as E,ka as f,kc as y,la as _,lb as N,mb as $,nb as s,o as k,ob as l,pb as d,sb as v,vb as h,wb as b,zb as D}from"./chunk-3OB67NIV.js";import{f as S}from"./chunk-FO65GQC2.js";var G=(()=>{let i=class i{constructor(){this.apiUrl=`${W.apiUrl}/skill`,this._http=T(U)}get(e){return this._http.get(`${this.apiUrl}/${e}`)}new(e){return this._http.post(this.apiUrl,e)}update(e){return this._http.put(`${this.apiUrl}/${e.id}`,e)}delete(e){return this._http.delete(`${this.apiUrl}/${e}`)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=F({token:i,factory:i.\u0275fac,providedIn:"root"});let r=i;return r})();var se=["nameInput"],re=(()=>{let i=class i{constructor(e,t,n,o,p){this._dialogRef=e,this._formBuilder=t,this._service=n,this._toast=o,this.data=p,this.editing=!1,this.form=this._formBuilder.group({id:"",name:["",[j.required]],skill_group:["",[j.required]]})}ngOnInit(){this.data.name&&(this.editing=!0),this.form.patchValue(this.data)}close(e){this._dialogRef.close(e)}submit(){return S(this,null,function*(){try{let e;this.editing?e=yield k(this._service.update(this.form.value)):e=yield k(this._service.new(this.form.value)),this.close(e)}catch(e){console.error(e),this._toast.error(e.error.detail),this.form.reset(),this.nameInput.nativeElement.focus()}})}};i.\u0275fac=function(t){return new(t||i)(a(X),a(K),a(G),a(te),a(Y))},i.\u0275cmp=w({type:i,selectors:[["app-new"]],viewQuery:function(t,n){if(t&1&&D(se,5),t&2){let o;M(o=R())&&(n.nameInput=o.first)}},standalone:!0,features:[x],decls:19,vars:3,consts:[["nameInput",""],["data-bs-theme","dark",1,"blur"],[1,"row","m-0"],[1,"col","ps-0"],[1,"col-auto","pe-0"],[1,"btn","btn-danger","btn-sm",3,"click"],[1,"fa-solid","fa-xmark"],[1,"mt-2",3,"ngSubmit","formGroup"],[1,"form-floating"],["type","text","id","nameInput","placeholder","","formControlName","name",1,"form-control"],["for","nameInput"],[1,"d-flex","justify-content-end","mt-2"],["type","button",1,"btn","btn-sm","btn-danger","me-2",3,"click"],["type","submit",1,"btn","btn-sm","btn-success",3,"disabled"]],template:function(t,n){if(t&1){let o=v();s(0,"div",1)(1,"div",2)(2,"div",3)(3,"h1"),m(4),l()(),s(5,"div",4)(6,"button",5),h("click",function(){return f(o),_(n.close())}),d(7,"em",6),l()()(),s(8,"form",7),h("ngSubmit",function(){return f(o),_(n.submit())}),s(9,"div",8),d(10,"input",9,0),s(12,"label",10),m(13,"Nombre"),l()(),s(14,"div",11)(15,"button",12),h("click",function(){return f(o),_(n.close())}),m(16,"Cancelar"),l(),s(17,"button",13),m(18,"Guardar"),l()()()()}t&2&&(u(4),C(n.editing?"Modificar habilidad":"Nueva habilidad"),u(4),V("formGroup",n.form),u(9),V("disabled",n.form.invalid))},dependencies:[y,P,H,Q,q,L,z,J],encapsulation:2});let r=i;return r})();var le=(r,i)=>i.id;function ae(r,i){if(r&1){let c=v();s(0,"button",15),h("click",function(){f(c);let t=b(),n=t.$implicit,o=t.$index,p=b(2);return _(p.newSkillGroup(n,o))}),d(1,"em",16),l(),s(2,"button",17),h("click",function(){f(c);let t=b(),n=t.$implicit,o=t.$index,p=b(2);return _(p.delete(n.id,o))}),d(3,"em",18),l()}}function ce(r,i){if(r&1&&(s(0,"tr")(1,"td"),m(2),l(),s(3,"td"),I(4,ae,4,0),l()()),r&2){let c=i.$implicit;u(2),C(c.name),u(2),E(4,c.id?4:-1)}}function me(r,i){if(r&1){let c=v();s(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),d(4,"em",4),m(5," Grupos de habilidades "),l()(),s(6,"div",5)(7,"h1",6),m(8),l()(),s(9,"div",7)(10,"button",8),h("click",function(){f(c);let t=b();return _(t.newSkillGroup({skill_group:t.skillGroup.id}))}),d(11,"em",9),l()()(),s(12,"div",10)(13,"table",11)(14,"thead")(15,"tr")(16,"th",12),m(17,"Nombre"),l(),d(18,"th",13),l()(),s(19,"tbody",14),N(20,ce,5,2,"tr",null,le),l()()()()}if(r&2){let c=b();u(8),A("Habilidades de ",c.skillGroup.name,""),u(12),$(c.skillGroup.skills)}}var Ee=(()=>{let i=class i{constructor(e,t,n,o){this._dialog=e,this._skillGroupsService=t,this._service=n,this._route=o,this.skillGroupSubs=new g,this.skillSubs=new g,this.routeSubs=new g,this.ready=!1}ngOnInit(){this.routeSubs=this._route.params.subscribe({next:e=>{this.skillGroupSubs=this._skillGroupsService.getById(e.skill_group_id).subscribe({next:t=>{this.skillGroup=t,this.skillGroup.id&&(this.skillGroupSubs=this._service.get(this.skillGroup.id).subscribe({next:n=>{this.skillGroup.skills=n,this.ready=!0,this.skillSubs.unsubscribe(),this.skillGroupSubs.unsubscribe(),this.routeSubs.unsubscribe()}}))}})}})}newSkillGroup(e,t){this._dialog.open(re,{width:"50%",data:e}).afterClosed().subscribe(o=>{console.log({type:typeof o,index:t}),typeof o=="boolean"&&t!=null?(console.log({pre:this.skillGroup.skills[t],post:this.skillGroup.skills[t]=e,item:e}),this.skillGroup.skills[t]=e):typeof o=="object"?(console.log("entra2"),this.skillGroup.skills.push(o)):console.log("entra3")})}delete(e,t){return S(this,null,function*(){try{yield k(this._service.delete(e)),this.skillGroup.skills.splice(t,1)}catch(n){console.error(n)}})}ngOnDestroy(){this.skillGroupSubs.unsubscribe(),this.routeSubs.unsubscribe()}};i.\u0275fac=function(t){return new(t||i)(a(Z),a(ee),a(G),a(B))},i.\u0275cmp=w({type:i,selectors:[["app-skills"]],standalone:!0,features:[x],decls:1,vars:1,consts:[["data-bs-theme","dark"],[1,"row","blur"],[1,"col-auto","ps-0"],["routerLink","/skill-groups",1,"btn","btn-warning","btn-sm"],[1,"fa-solid","fa-chevron-left"],[1,"col","ps-0"],[1,"text-center"],[1,"col-auto","pe-0"],[1,"btn","btn-success","btn-sm",3,"click"],[1,"fa-solid","fa-plus"],[1,"row","blur","mt-2"],[1,"table","table-sm","blur","m-0"],["scope","col"],[2,"width","75px"],[1,"table-group-divider"],[1,"btn","btn-sm","btn-primary","me-1",3,"click"],[1,"fa-solid","fa-pen"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fa-solid","fa-trash"]],template:function(t,n){t&1&&I(0,me,22,1,"div",0),t&2&&E(0,n.ready?0:-1)},dependencies:[y,O],encapsulation:2});let r=i;return r})();export{Ee as default};
